# daily-chain-backup

A Helm chart for deploying cron job to periodically run chain backups and upload to GCS

![Version: 1.0.2](https://img.shields.io/badge/Version-1.0.2-informational?style=flat-square) ![AppVersion: 1.0](https://img.shields.io/badge/AppVersion-1.0-informational?style=flat-square)

- [daily-chain-backup](#daily-chain-backup)
  - [Chart releases](#chart-releases)
  - [Basic chart operation](#basic-chart-operation)

## Chart releases

Chart is released to oci://us-west1-docker.pkg.dev/celo-testnet/clabs-public-oci/daily-chain-backup repository automatically every commit to `master` branch.
Just remind yourself to bump the version of the chart in the [Chart.yaml](./Chart.yaml) file.
This process is configured using GitHub Actions in the [helm_release.yml](../../.github/workflows/helm_release.yml)
and [helm_test.yml](../../.github/workflows/helm_test.yml) files.

## Basic chart operation

To import this chart into your chart, add the following to your `requirements.yaml` file:

```yaml
dependencies:
  - name: daily-chain-backup
    repository: oci://us-west1-docker.pkg.dev/celo-testnet/clabs-public-oci
    version: 1.0.2
```

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| formats | object | `{"use_gzip":false,"use_lz4":false,"use_zstd":true}` | Which format enable to compress. Multiple can be enabled at the same time. |
| geth.diskSizeGB | int | `300` | Size of PVC to create for geth data |
| geth.gcmode | string | `"full"` | GCmode for celo-blockchain |
| geth.gstorage_data_bucket | string | `"celo-chain-backup/mainnet"` | GCS bucket to upload chain backups to |
| geth.image | object | `{"imagePullPolicy":"Always","repository":"us.gcr.io/celo-org/geth","tag":1}` | celo-blockchain image to use |
| geth.in_memory_discovery_table | bool | `false` | enable use-in-memory-discovery-table celo-blockchain flag |
| geth.metrics | bool | `true` | Enable metrics options |
| geth.resources | object | `{"requests":{"cpu":"2","memory":"4Gi"}}` | resources to allocate to geth container |
| geth.syncmode | string | `"full"` | Syncmode for celo-blockchain |
| geth.verbosity | int | `2` | Verbosity level for celo-blockchain |
| geth.vmodule | string | `""` | Custom log level for celo-blockchain |
| pprof | object | `{"enabled":false}` | Enable profiling options |
| serviceAccount | string | `"chaindata-upload@celo-testnet.iam.gserviceaccount.com"` | GCP Service Account to use for uploading chain backups (using workload identity) |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.11.3](https://github.com/norwoodj/helm-docs/releases/v1.11.3). To regenerate run `helm-docs` command at this folder.
