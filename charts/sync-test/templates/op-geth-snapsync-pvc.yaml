{{- if and (not .Values.snapshot.enabled) (not (lookup "v1" "PersistentVolumeClaim" .Release.Namespace (printf "data-%s-op-geth-0" .Release.Name))) }}
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: data-{{ .Release.Name }}-op-geth-0
  labels:
    {{- include "sync-test.labels" . | nindent 4 }}
  annotations:
    helm.sh/resource-policy: keep
    resize.topolvm.io/increase: "10%"
    resize.topolvm.io/inodes-threshold: "10%"
    resize.topolvm.io/storage_limit: "4000Gi"
    resize.topolvm.io/threshold: "10%"
spec:
  accessModes: [ReadWriteOnce]
  storageClassName: {{ (index .Values "op-geth").persistence.pvc.storageClass }}
  resources:
    requests:
      storage: {{ (index .Values "op-geth").persistence.pvc.size }}
{{- end }}
