---
# Snapshot-based PVC configuration (used for consensus and execution sync modes)
snapshot:
  enabled: true
  storageClass: premium-rwo
  storageSize: 25Gi
  volumeSnapshotName: ""  # REQUIRED for consensus/execution: set via --set snapshot.volumeSnapshotName=...

# -- op-geth subchart values
op-geth:
  replicaCount: 1

  image:
    repository: ""  # REQUIRED: set via --set op-geth.image.repository=...
    tag: ""         # REQUIRED: set via --set op-geth.image.tag=...

  secrets:
    jwt: &jwt
      value: "4602272743680c6e128634f6a3db7078ca5f74d0f2f3db960a9a9717e72a270c"
    nodeKey:
      value: ""  # REQUIRED: set via --set op-geth.secrets.nodeKey.value=0x$(openssl rand -hex 32)

  config:
    op-network: ""
    networkid: ""   # Set via network file
    datadir: /celo
    syncmode: full
    gcmode: full
    snapshot: true
    maxpeers: 300
    nodiscover: false
    bootnodes: []   # Set via network file
    http:
      api: [eth, net, web3, debug, txpool, engine]
    ws:
      enabled: true
      api: [eth, net, debug, txpool, engine]
    rollup:
      disabletxpoolgossip: true
      sequencerhttp: ""  # Set via network file
    metrics:
      enabled: true

  extraArgs: []  # Set via network file (e.g. --rollup.historicalrpc)

  init:
    genesis:
      enabled: false
      url: ""  # Set via network file
    rollup:
      enabled: false
      url: ""  # Set via network file

  persistence:
    pvc:
      size: 25Gi
      storageClass: premium-rwo
      annotations:
        resize.topolvm.io/increase: "10%"
        resize.topolvm.io/inodes-threshold: "10%"
        resize.topolvm.io/storage_limit: 4000Gi
        resize.topolvm.io/threshold: "10%"

  resources:
    requests:
      cpu: 2.5
      memory: 4.5Gi

  services:
    p2p:
      enabled: true
      type: ClusterIP

  ingress:
    http:
      enabled: false

# -- op-node subchart values
op-node:
  replicaCount: 1

  image:
    repository: ""  # REQUIRED: set via --set op-node.image.repository=...
    tag: ""         # REQUIRED: set via --set op-node.image.tag=...

  secrets:
    jwt: *jwt
    l1Url:
      value: ""     # Set via network file
    l1BeaconUrl:
      value: ""     # Set via network file
    p2pKeys:
      value: ""  # REQUIRED: set via --set op-node.secrets.p2pKeys.value=0x$(openssl rand -hex 32)

  config:
    network: ""
    enableAdmin: true
    syncmode: consensus-layer
    safedbPath: /celo/safedb
    l1:
      rpckind: ""     # Set via network file
      trustrpc: true
    l2:
      # Resolved at render time via tpl â€” produces e.g. http://cr16-consensus-op-geth-authrpc-0:8551
      url: "http://{{ .Release.Name }}-op-geth-authrpc-0:8551"
      protocol: ""
      namePattern: ""
      port: ""
    rollup:
      loadProtocolVersions: true
      halt: ""
    sequencer:
      enabled: false
    verifier:
      l1Confs: 4
    altda:
      enabled: true
      daServer: http://eigenda-proxy-api:4242
      daService: true
      verifyOnRead: false
    metrics:
      enabled: true
    p2p:
      nat: false
      port: 9222
      peers:
        hi: 400
        lo: 250
      bootnodes: []  # Set via network file

  init:
    rollup:
      enabled: true
      url: ""  # Set via network file

  persistence:
    type: pvc
    pvc:
      size: 1Gi
      storageClass: standard-rwo
      annotations:
        resize.topolvm.io/increase: "10%"
        resize.topolvm.io/inodes-threshold: "10%"
        resize.topolvm.io/storage_limit: 50Gi
        resize.topolvm.io/threshold: "10%"

  resources:
    requests:
      cpu: 400m
      memory: 1Gi

  services:
    p2p:
      enabled: true
      type: ClusterIP
      port: 9222
      publishNotReadyAddresses: true

  terminationGracePeriodSeconds: 30
